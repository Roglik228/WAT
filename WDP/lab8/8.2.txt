#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_LINE_LENGTH 100
#define NUMBERS_PER_LINE 10

// Funkcja do odczytu liczb z pliku i wyświetlenia ich na ekranie
void readAndDisplayNumbers(const char* filename) {
    FILE* file = fopen(filename, "r");
    if (file == NULL) {
        printf("Błąd podczas otwierania pliku %s\n", filename);
        return;
    }

    char line[MAX_LINE_LENGTH];
    int count = 0;
    while (fgets(line, MAX_LINE_LENGTH, file) != NULL) {
        int number;
        sscanf(line, "%d", &number);
        printf("%d ", number);
        count++;
        if (count % NUMBERS_PER_LINE == 0) {
            printf("\n");
        }
    }

    printf("\n");
    fclose(file);
}

// Funkcja do sortowania liczb
void sortNumbers(int* numbers, int count) {
    for (int i = 0; i < count - 1; i++) {
        for (int j = i + 1; j < count; j++) {
            if (numbers[i] > numbers[j]) {
                int temp = numbers[i];
                numbers[i] = numbers[j];
                numbers[j] = temp;
            }
        }
    }
}

// Funkcja do zapisania posortowanych liczb do pliku i wyświetlenia ich na ekranie
void wynik(const char* filename, int* numbers, int count) {
    FILE* file = fopen(filename, "w");
    if (file == NULL) {
        printf("Błąd podczas otwierania pliku %s\n", filename);
        return;
    }

    int printedNumbers = 0;
    for (int i = 0; i < count; i++) {
        fprintf(file, "%-5d ", numbers[i]); 
        printf("%-5d ", numbers[i]); 
        printedNumbers++;
        if (printedNumbers % NUMBERS_PER_LINE == 0) {
            fprintf(file, "\n");
            printf("\n");
        }
    }

    printf("\n");
    fclose(file);
}

int main() {
    char inputFilename[MAX_LINE_LENGTH];
    char outputFilename[MAX_LINE_LENGTH];
    //wpisanie danych
    printf("Podaj nazwę pliku wejściowego (*.txt): ");
    scanf("%s", inputFilename);
    printf("Podaj nazwę pliku wyjściowego (*.txt): ");
    scanf("%s", outputFilename);
    // Odczytanie liczb z pliku wejściowego i wyświetlenie ich na ekranie
    readAndDisplayNumbers(inputFilename);
    // Otwarcie pliku wejściowego do odczytu
    FILE* file = fopen(inputFilename, "r");
    if (file == NULL) {
        printf("Błąd podczas otwierania pliku %s\n", inputFilename);
        return 1;
    }
    // Odczytanie liczb z pliku wejściowego
    int numbers[MAX_LINE_LENGTH];
    int count = 0;
    while (fscanf(file, "%d", &numbers[count]) != EOF) {
        count++;
    }
    fclose(file);
    // Posortowanie liczb
    sortNumbers(numbers, count);
    // Zapisanie posortowanych liczb do pliku wyjściowego i wyświetlenie ich na ekranie
    wynik(outputFilename, numbers, count);

    return 0;
}